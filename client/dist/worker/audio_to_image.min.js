/*jslint browser: true*/
/*continue: true*/
/*global self,postMessage*/

/*
    Dedicated worker to convert audio data to image data (aka. spectrum), quite generic!
*/

/***********************************************************
    Include.
************************************************************/

// dependency
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CCWT=t():e.CCWT=t()}(this,(function(){return function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1)}([function(e,t){var i,n,r=e.exports={};function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function u(e){if(i===setTimeout)return setTimeout(e,0);if((i===a||!i)&&setTimeout)return i=setTimeout,setTimeout(e,0);try{return i(e,0)}catch(t){try{return i.call(null,e,0)}catch(t){return i.call(this,e,0)}}}!function(){try{i="function"==typeof setTimeout?setTimeout:a}catch(e){i=a}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(e){n=o}}();var l,s=[],f=!1,c=-1;function d(){f&&l&&(f=!1,l.length?s=l.concat(s):c=-1,s.length&&h())}function h(){if(!f){var e=u(d);f=!0;for(var t=s.length;t;){for(l=s,s=[];++c<t;)l&&l[c].run();c=-1,t=s.length}l=null,f=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function _(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)t[i-1]=arguments[i];s.push(new _(e,t)),1!==s.length||f||u(h)},_.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},function(e,t,i){e.exports=i(2)},function(e,t,i){const n=i(3)(),r={onReady:null};n.onRuntimeInitialized=()=>{const e=n.cwrap("fftwf_plan_dft_r2c_1d","number",["number","number","number","number"]),t=n.cwrap("fftwf_plan_dft_1d","number",["number","number","number","number","number"]),i=n.cwrap("fftwf_execute","void",["number"]),a=n.cwrap("fftwf_destroy_plan","void",["number"]),o=n.cwrap("fftwf_free","void",["number"]),u=n.cwrap("fftwf_malloc","number",["number"]);r.fft1d=(t,r,l)=>{const s=t.length,f=s+2*r,c=u(8*f),d=u(8*f),h=new Float32Array(n.HEAPU8.buffer,c,2*f),_=new Float32Array(n.HEAPU8.buffer,d,2*f);let p=0;for(p=0;p<r;++p)h[p]=h[f-p-1]=0;for(p=0;p<s;++p)h[r+p]=2*t[p]*l;for(p=f;p<2*f;++p)h[p]=0;const m=e(f,c,d,64);return i(m),a(m),o(c),o(d),_},r.frequencyBand=(e,t,i,n,r)=>{const a=new Float32Array(2*e);r*=Math.sqrt(1/(4*Math.PI)),0==t&&(t=e/2);let o=0;for(o=0;o<e;++o){let u=t*(1-o/e)+i,l=t/e;n>0&&(u=Math.pow(n,u),l*=Math.log(n)*u),a[2*o]=u,a[2*o+1]=l*r}return a},r.numericOutput=(e,r,l,s,f,c,d)=>{const h=e.length/2,_=h-2*r,p=c*(h/_);if(0===c&&(c=_),c>_)return-2;const m=u(8*p),w=u(8*p),T=new Float32Array(n.HEAPU8.buffer,m,2*p),y=new Float32Array(n.HEAPU8.buffer,w,2*p),E=t(p,m,w,1,0),g=h>>1,b=1/h,v=h/_;let R=0;for(R=s;R<f;++R){const t=l[2*R]*v,n=1/(l[2*R+1]*p*v);let a=0;for(a=0;a<p;++a){const i=g-Math.abs(Math.abs(a-t)-g);let r=e[2*a],o=e[2*a+1];const u=Math.exp(-i*i*n);r*=u*b,o*=u*b,T[2*a]=r,T[2*a+1]=o}if(p<h){const i=h%p,r=h-i;let a=0;for(a=p;a<r;a+=p){let i=0;for(i=0;i<p;++i){let r=a+i,o=2*a+2*i;const u=g-Math.abs(Math.abs(r-t)-g);let l=e[o],s=e[o+1];const f=Math.exp(-u*u*n);l*=f*b,s*=f*b;let c=T[2*i]+l,d=T[2*i+1]+s;T[2*i]=c,T[2*i+1]=d}}let o=0;for(o=0;o<i;++o){let i=r+o,a=2*r+2*o;const u=g-Math.abs(Math.abs(i-t)-g);let l=e[a],s=e[a+1];const f=Math.exp(-u*u*n);l*=f*b,s*=f*b;let c=T[2*o]+l,d=T[2*o+1]+s;T[2*o]=c,T[2*o+1]=d}}i(E),d(R,y,r*(c/_))}return a(E),o(m),o(w),0},null!==r.onReady?r.onReady():console.log("ccwt.js : unregistered onReady callback")},e.exports=r},function(e,t,i){(function(t,n){var r,a=(r="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,function(e){var a,o=void 0!==(e=e||{})?e:{},u={};for(a in o)o.hasOwnProperty(a)&&(u[a]=o[a]);o.arguments=[],o.thisProgram="./this.program",o.quit=function(e,t){throw t},o.preRun=[],o.postRun=[];var l=!1,s=!1,f=!1,c=!1;if(l="object"==typeof window,s="function"==typeof importScripts,f="object"==typeof t&&!l&&!s,c=!l&&!f&&!s,o.ENVIRONMENT)throw new Error("Module.ENVIRONMENT has been deprecated. To force the environment, use the ENVIRONMENT compile-time option (for example, -s ENVIRONMENT=web or -s ENVIRONMENT=node)");var d,h,_="";function p(e){return o.locateFile?o.locateFile(e,_):_+e}if(f)_=n+"/",o.read=function(e,t){var n;return d||(d=i(!function(){var e=new Error("Cannot find module 'fs'");throw e.code="MODULE_NOT_FOUND",e}())),h||(h=i(4)),e=h.normalize(e),n=d.readFileSync(e),t?n:n.toString()},o.readBinary=function(e){var t=o.read(e,!0);return t.buffer||(t=new Uint8Array(t)),M(t.buffer),t},t.argv.length>1&&(o.thisProgram=t.argv[1].replace(/\\/g,"/")),o.arguments=t.argv.slice(2),t.on("uncaughtException",(function(e){if(!(e instanceof jt))throw e})),t.on("unhandledRejection",Vt),o.quit=function(e){t.exit(e)},o.inspect=function(){return"[Emscripten Module object]"};else if(c)"undefined"!=typeof read&&(o.read=function(e){return read(e)}),o.readBinary=function(e){var t;return"function"==typeof readbuffer?new Uint8Array(readbuffer(e)):(M("object"==typeof(t=read(e,"binary"))),t)},"undefined"!=typeof scriptArgs?o.arguments=scriptArgs:void 0!==arguments&&(o.arguments=arguments),"function"==typeof quit&&(o.quit=function(e){quit(e)});else{if(!l&&!s)throw new Error("environment detection error");s?_=self.location.href:document.currentScript&&(_=document.currentScript.src),r&&(_=r),_=0!==_.indexOf("blob:")?_.substr(0,_.lastIndexOf("/")+1):"",o.read=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.send(null),t.responseText},s&&(o.readBinary=function(e){var t=new XMLHttpRequest;return t.open("GET",e,!1),t.responseType="arraybuffer",t.send(null),new Uint8Array(t.response)}),o.readAsync=function(e,t,i){var n=new XMLHttpRequest;n.open("GET",e,!0),n.responseType="arraybuffer",n.onload=function(){200==n.status||0==n.status&&n.response?t(n.response):i()},n.onerror=i,n.send(null)},o.setWindowTitle=function(e){document.title=e}}var m=o.print||("undefined"!=typeof console?console.log.bind(console):"undefined"!=typeof print?print:null),w=o.printErr||("undefined"!=typeof printErr?printErr:"undefined"!=typeof console&&console.warn.bind(console)||m);for(a in u)u.hasOwnProperty(a)&&(o[a]=u[a]);function T(e){T.shown||(T.shown={}),T.shown[e]||(T.shown[e]=1,w(e))}u=void 0,M(void 0===o.memoryInitializerPrefixURL,"Module.memoryInitializerPrefixURL option was removed, use Module.locateFile instead"),M(void 0===o.pthreadMainPrefixURL,"Module.pthreadMainPrefixURL option was removed, use Module.locateFile instead"),M(void 0===o.cdInitializerPrefixURL,"Module.cdInitializerPrefixURL option was removed, use Module.locateFile instead"),M(void 0===o.filePackagePrefixURL,"Module.filePackagePrefixURL option was removed, use Module.locateFile instead"),Wt=Bt=Qt=function(){Vt("cannot use the stack before compiled code is ready to run, and has provided stack access")};var y={"f64-rem":function(e,t){return e%t},debugger:function(){}};new Array(0);var E=0,g=function(e){E=e},b=function(){return E},v=1024,R=!1;function M(e,t){e||Vt("Assertion failed: "+t)}function O(e){var t=o["_"+e];return M(t,"Cannot call unknown function "+e+", make sure it is exported"),t}var A={stackSave:function(){Wt()},stackRestore:function(){Bt()},arrayToC:function(e){var t=Qt(e.length);return ve(e,t),t},stringToC:function(e){var t=0;if(null!=e&&0!==e){var i=1+(e.length<<2);P(e,t=Qt(i),i)}return t}},I={string:A.stringToC,array:A.arrayToC};function S(e,t,i,n,r){var a=O(e),o=[],u=0;if(M("array"!==t,'Return type should not be "array".'),n)for(var l=0;l<n.length;l++){var s=I[i[l]];s?(0===u&&(u=Wt()),o[l]=s(n[l])):o[l]=n[l]}var f=a.apply(null,o);return f=function(e){return"string"===t?x(e):"boolean"===t?Boolean(e):e}(f),0!==u&&Bt(u),f}function N(e,t,i,n){return function(){return S(e,t,i,arguments)}}function x(e,t){if(0===t||!e)return"";for(var i,n=0,r=0;M(e+r<le),n|=i=W[e+r>>0],(0!=i||t)&&(r++,!t||r!=t););t||(t=r);var a="";if(n<128){for(var o;t>0;)o=String.fromCharCode.apply(String,W.subarray(e,e+Math.min(t,1024))),a=a?a+o:o,e+=1024,t-=1024;return a}return X(e)}var F="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function U(e,t){for(var i=t;e[i];)++i;if(i-t>16&&e.subarray&&F)return F.decode(e.subarray(t,i));for(var n,r,a,o,u,l="";;){if(!(n=e[t++]))return l;if(128&n)if(r=63&e[t++],192!=(224&n))if(a=63&e[t++],224==(240&n)?n=(15&n)<<12|r<<6|a:(o=63&e[t++],240==(248&n)?n=(7&n)<<18|r<<12|a<<6|o:(u=63&e[t++],n=248==(252&n)?(3&n)<<24|r<<18|a<<12|o<<6|u:(1&n)<<30|r<<24|a<<18|o<<12|u<<6|63&e[t++])),n<65536)l+=String.fromCharCode(n);else{var s=n-65536;l+=String.fromCharCode(55296|s>>10,56320|1023&s)}else l+=String.fromCharCode((31&n)<<6|r);else l+=String.fromCharCode(n)}}function X(e){return U(W,e)}function D(e,t,i,n){if(!(n>0))return 0;for(var r=i,a=i+n-1,o=0;o<e.length;++o){var u=e.charCodeAt(o);if(u>=55296&&u<=57343&&(u=65536+((1023&u)<<10)|1023&e.charCodeAt(++o)),u<=127){if(i>=a)break;t[i++]=u}else if(u<=2047){if(i+1>=a)break;t[i++]=192|u>>6,t[i++]=128|63&u}else if(u<=65535){if(i+2>=a)break;t[i++]=224|u>>12,t[i++]=128|u>>6&63,t[i++]=128|63&u}else if(u<=2097151){if(i+3>=a)break;t[i++]=240|u>>18,t[i++]=128|u>>12&63,t[i++]=128|u>>6&63,t[i++]=128|63&u}else if(u<=67108863){if(i+4>=a)break;t[i++]=248|u>>24,t[i++]=128|u>>18&63,t[i++]=128|u>>12&63,t[i++]=128|u>>6&63,t[i++]=128|63&u}else{if(i+5>=a)break;t[i++]=252|u>>30,t[i++]=128|u>>24&63,t[i++]=128|u>>18&63,t[i++]=128|u>>12&63,t[i++]=128|u>>6&63,t[i++]=128|63&u}}return t[i]=0,i-r}function P(e,t,i){return M("number"==typeof i,"stringToUTF8(str, outPtr, maxBytesToWrite) is missing the third parameter that specifies the length of the output buffer!"),D(e,W,t,i)}function L(e){return T("warning: build with  -s DEMANGLE_SUPPORT=1  to link in libcxxabi demangling"),e}function k(e){return e.replace(/__Z[\w\d_]+/g,(function(e){var t=L(e);return e===t?e:t+" ["+e+"]"}))}function C(){var e=new Error;if(!e.stack){try{throw new Error(0)}catch(t){e=t}if(!e.stack)return"(no stack trace available)"}return e.stack.toString()}function H(){var e=C();return o.extraStackTrace&&(e+="\n"+o.extraStackTrace()),k(e)}"undefined"!=typeof TextDecoder&&new TextDecoder("utf-16le");var Q,B,W,j,Y,z,V=65536;function G(e,t){return e%t>0&&(e+=t-e%t),e}function q(e){o.buffer=Q=e}function K(){o.HEAP8=B=new Int8Array(Q),o.HEAP16=j=new Int16Array(Q),o.HEAP32=Y=new Int32Array(Q),o.HEAPU8=W=new Uint8Array(Q),o.HEAPU16=new Uint16Array(Q),o.HEAPU32=z=new Uint32Array(Q),o.HEAPF32=new Float32Array(Q),o.HEAPF64=new Float64Array(Q)}var J=1024,Z=36080,$=5278960,ee=5278960,te=35824;function ie(){M(0==(3&$)),z[($>>2)-1]=34821223,z[($>>2)-2]=2310721022}function ne(){if(34821223==z[($>>2)-1]&&2310721022==z[($>>2)-2]||Vt("Stack overflow! Stack cookie has been overwritten, expected hex dwords 0x89BACDFE and 0x02135467, but received 0x"+z[($>>2)-2].toString(16)+" "+z[($>>2)-1].toString(16)),1668509029!==Y[0])throw"Runtime error: The application has corrupted its heap memory area (address zero)!"}function re(e){Vt("Stack overflow! Attempted to allocate "+e+" bytes on the stack, but stack has only "+($-Wt()+e)+" bytes available!")}function ae(){Vt("Cannot enlarge memory arrays. Either (1) compile with  -s TOTAL_MEMORY=X  with X higher than the current value "+le+", (2) compile with  -s ALLOW_MEMORY_GROWTH=1  which allows increasing the size at runtime, or (3) if you want malloc to return NULL (0) instead of this abort, compile with  -s ABORTING_MALLOC=0 ")}function oe(){ae()}M(Z%16==0,"stack must start aligned"),M(ee%16==0,"heap must start aligned");var ue=5242880;o.TOTAL_STACK&&M(ue===o.TOTAL_STACK,"the stack size can no longer be determined at runtime");var le=o.TOTAL_MEMORY||16777216;function se(){return le}if(le<ue&&w("TOTAL_MEMORY should be larger than TOTAL_STACK, was "+le+"! (TOTAL_STACK="+ue+")"),M("undefined"!=typeof Int32Array&&"undefined"!=typeof Float64Array&&void 0!==Int32Array.prototype.subarray&&void 0!==Int32Array.prototype.set,"JS engine does not provide full typed array support"),o.buffer?M((Q=o.buffer).byteLength===le,"provided buffer should be "+le+" bytes, but it is "+Q.byteLength):("object"==typeof WebAssembly&&"function"==typeof WebAssembly.Memory?(M(le%V==0),o.wasmMemory=new WebAssembly.Memory({initial:le/V,maximum:le/V}),Q=o.wasmMemory.buffer):Q=new ArrayBuffer(le),M(Q.byteLength===le),o.buffer=Q),K(),Y[te>>2]=ee,Y[0]=1668509029,j[1]=25459,115!==W[2]||99!==W[3])throw"Runtime error: expected the system to be little-endian!";function fe(e){for(;e.length>0;){var t=e.shift();if("function"!=typeof t){var i=t.func;"number"==typeof i?void 0===t.arg?o.dynCall_v(i):o.dynCall_vi(i,t.arg):i(void 0===t.arg?null:t.arg)}else t()}}var ce=[],de=[],he=[],_e=[],pe=!1,me=!1;function we(){if(o.preRun)for("function"==typeof o.preRun&&(o.preRun=[o.preRun]);o.preRun.length;)ge(o.preRun.shift());fe(ce)}function Te(){ne(),pe||(pe=!0,fe(de))}function ye(){ne(),fe(he)}function Ee(){if(ne(),o.postRun)for("function"==typeof o.postRun&&(o.postRun=[o.postRun]);o.postRun.length;)be(o.postRun.shift());fe(_e)}function ge(e){ce.unshift(e)}function be(e){_e.unshift(e)}function ve(e,t){M(e.length>=0,"writeArrayToMemory array must have a length (should be an array or typed array)"),B.set(e,t)}M(Math.imul,"This browser does not support Math.imul(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),M(Math.fround,"This browser does not support Math.fround(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),M(Math.clz32,"This browser does not support Math.clz32(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),M(Math.trunc,"This browser does not support Math.trunc(), build with LEGACY_VM_SUPPORT or POLYFILL_OLD_MATH_FUNCTIONS to add in a polyfill"),Math.abs;var Re=Math.cos,Me=Math.sin,Oe=(Math.tan,Math.acos,Math.asin,Math.atan,Math.atan2,Math.exp,Math.log,Math.sqrt,Math.ceil,Math.floor,Math.pow,Math.imul,Math.fround,Math.round,Math.min,Math.max,Math.clz32,Math.trunc,0),Ae=null,Ie=null,Se={};function Ne(e){Oe++,o.monitorRunDependencies&&o.monitorRunDependencies(Oe),e?(M(!Se[e]),Se[e]=1,null===Ae&&"undefined"!=typeof setInterval&&(Ae=setInterval((function(){if(R)return clearInterval(Ae),void(Ae=null);var e=!1;for(var t in Se)e||(e=!0,w("still waiting on run dependencies:")),w("dependency: "+t);e&&w("(end of list)")}),1e4))):w("warning: run dependency added without ID")}function xe(e){if(Oe--,o.monitorRunDependencies&&o.monitorRunDependencies(Oe),e?(M(Se[e]),delete Se[e]):w("warning: run dependency removed without ID"),0==Oe&&(null!==Ae&&(clearInterval(Ae),Ae=null),Ie)){var t=Ie;Ie=null,t()}}o.preloadedImages={},o.preloadedAudios={};var Fe={error:function(){Vt("Filesystem support (FS) was not included. The problem is that you are using files from JS, but files were not used from C/C++, so filesystem support was not auto-included. You can force-include filesystem support with  -s FORCE_FILESYSTEM=1")},init:function(){Fe.error()},createDataFile:function(){Fe.error()},createPreloadedFile:function(){Fe.error()},createLazyFile:function(){Fe.error()},open:function(){Fe.error()},mkdev:function(){Fe.error()},registerDevice:function(){Fe.error()},analyzePath:function(){Fe.error()},loadFilesFromDB:function(){Fe.error()},ErrnoError:function(){Fe.error()}};o.FS_createDataFile=Fe.createDataFile,o.FS_createPreloadedFile=Fe.createPreloadedFile;var Ue="data:application/octet-stream;base64,";function Xe(e){return String.prototype.startsWith?e.startsWith(Ue):0===e.indexOf(Ue)}function De(){var e="FFTW.wasm";Xe(e)||(e=p(e));var t={global:null,env:null,asm2wasm:y,parent:o},i=null;function n(){try{if(o.wasmBinary)return new Uint8Array(o.wasmBinary);if(o.readBinary)return o.readBinary(e);throw"both async and sync fetching of the wasm failed"}catch(e){Vt(e)}}function r(r,a,u){if("object"!=typeof WebAssembly)return Vt("No WebAssembly support found. Build with -s WASM=0 to target JavaScript instead."),w("no native wasm support detected"),!1;if(!(o.wasmMemory instanceof WebAssembly.Memory))return w("no native wasm Memory in use"),!1;function f(e,t){(i=e.exports).memory&&function(e){var t=o.buffer;e.byteLength<t.byteLength&&w("the new buffer in mergeMemory is smaller than the previous one. in native wasm, we should grow memory here");var i=new Int8Array(t);new Int8Array(e).set(i),q(e),K()}(i.memory),o.asm=i,xe("wasm-instantiate")}if(a.memory=o.wasmMemory,t.global={NaN:NaN,Infinity:1/0},t["global.Math"]=Math,t.env=a,Ne("wasm-instantiate"),o.instantiateWasm)try{return o.instantiateWasm(t,f)}catch(e){return w("Module.instantiateWasm callback failed with error: "+e),!1}var c=o;function d(e){M(o===c,"the Module object should not be replaced during async compilation - perhaps the order of HTML elements is wrong?"),c=null,f(e.instance,e.module)}function h(i){(o.wasmBinary||!l&&!s||"function"!=typeof fetch?new Promise((function(e,t){e(n())})):fetch(e,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+e+"'";return t.arrayBuffer()})).catch((function(){return n()}))).then((function(e){return WebAssembly.instantiate(e,t)})).then(i,(function(e){w("failed to asynchronously prepare wasm: "+e),Vt(e)}))}return o.wasmBinary||"function"!=typeof WebAssembly.instantiateStreaming||Xe(e)||"function"!=typeof fetch?h(d):WebAssembly.instantiateStreaming(fetch(e,{credentials:"same-origin"}),t).then(d,(function(e){w("wasm streaming compile failed: "+e),w("falling back to ArrayBuffer instantiation"),h(d)})),{}}o.asmPreload=o.asm,o.reallocBuffer=function(e){return function(e){e=G(e,65536);var t=o.buffer.byteLength;try{return-1!==o.wasmMemory.grow((e-t)/65536)?o.buffer=o.wasmMemory.buffer:null}catch(i){return console.error("Module.reallocBuffer: Attempted to grow from "+t+" bytes to "+e+" bytes, but got error: "+i),null}}(e)},o.asm=function(e,t,i){if(!t.table){M(void 0!==o.wasmTableSize);var n=o.wasmTableSize,a=o.wasmMaxTableSize;"object"==typeof WebAssembly&&"function"==typeof WebAssembly.Table?t.table=void 0!==a?new WebAssembly.Table({initial:n,maximum:a,element:"anyfunc"}):new WebAssembly.Table({initial:n,element:"anyfunc"}):t.table=new Array(n),o.wasmTable=t.table}t.__memory_base||(t.__memory_base=o.STATIC_BASE),t.__table_base||(t.__table_base=0);var u=r(0,t);return M(u,"binaryen setup failed (no wasm support?)"),u}}De(),J=v,de.push();var Pe=35056;o.STATIC_BASE=J,o.STATIC_BUMP=Pe;var Le=36064;function ke(){}M(Le%8==0);var Ce={buffers:[null,[],[]],printChar:function(e,t){var i=Ce.buffers[e];M(i),0===t||10===t?((1===e?m:w)(U(i,0)),i.length=0):i.push(t)},varargs:0,get:function(e){return Ce.varargs+=4,Y[Ce.varargs-4>>2]},getStr:function(){return X(Ce.get())},get64:function(){var e=Ce.get(),t=Ce.get();return M(e>=0?0===t:-1===t),e},getZero:function(){M(0===Ce.get())}};function He(e,t){Ce.varargs=t;try{var i=Ce.getStreamFromFD(),n=(Ce.get(),Ce.get()),r=Ce.get(),a=Ce.get(),o=n;return Fe.llseek(i,o,a),Y[r>>2]=i.position,i.getdents&&0===o&&0===a&&(i.getdents=null),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||Vt(e),-e.errno}}function Qe(){var e=o._fflush;e&&e(0);var t=Ce.buffers;t[1].length&&Ce.printChar(1,10),t[2].length&&Ce.printChar(2,10)}function Be(e,t){Ce.varargs=t;try{for(var i=Ce.get(),n=Ce.get(),r=Ce.get(),a=0,o=0;o<r;o++){for(var u=Y[n+8*o>>2],l=Y[n+(8*o+4)>>2],s=0;s<l;s++)Ce.printChar(i,W[u+s]);a+=l}return a}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||Vt(e),-e.errno}}function We(e,t){Ce.varargs=t;try{return 0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||Vt(e),-e.errno}}function je(e,t){Ce.varargs=t;try{var i=Ce.getStreamFromFD();return Fe.close(i),0}catch(e){return void 0!==Fe&&e instanceof Fe.ErrnoError||Vt(e),-e.errno}}function Ye(){}function ze(){o.abort()}function Ve(){Vt()}function Ge(){return f||"undefined"!=typeof dateNow||(l||s)&&self.performance&&self.performance.now}function qe(e){return o.___errno_location?Y[o.___errno_location()>>2]=e:w("failed to set errno from JS"),e}function Ke(e,t){var i=performance.now();return Y[t>>2]=i/1e3|0,Y[t+4>>2]=i%1e3*1e3*1e3|0,0}function Je(e){var t=Date.now();return Y[e>>2]=t/1e3|0,Y[e+4>>2]=t%1e3*1e3|0,0}var Ze=Re,$e=Me;function et(e,t,i){return W.set(W.subarray(t,t+i),e),e}function tt(e){w("Invalid function pointer called with signature 'didi'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function it(e){w("Invalid function pointer called with signature 'ii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function nt(e){w("Invalid function pointer called with signature 'iii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function rt(e){w("Invalid function pointer called with signature 'iiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function at(e){w("Invalid function pointer called with signature 'iiiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function ot(e){w("Invalid function pointer called with signature 'iiiiiiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function ut(e){w("Invalid function pointer called with signature 'iiiiiiiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function lt(e){w("Invalid function pointer called with signature 'iiiiiiiiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function st(e){w("Invalid function pointer called with signature 'iiiiiiiiiiiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function ft(e){w("Invalid function pointer called with signature 'vi'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function ct(e){w("Invalid function pointer called with signature 'vii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function dt(e){w("Invalid function pointer called with signature 'viiffi'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function ht(e){w("Invalid function pointer called with signature 'viii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function _t(e){w("Invalid function pointer called with signature 'viiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function pt(e){w("Invalid function pointer called with signature 'viiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function mt(e){w("Invalid function pointer called with signature 'viiiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function wt(e){w("Invalid function pointer called with signature 'viiiiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function Tt(e){w("Invalid function pointer called with signature 'viiiiiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}function yt(e){w("Invalid function pointer called with signature 'viiiiiiiiii'. Perhaps this is an invalid value (e.g. caused by calling a virtual method on a NULL pointer)? Or calling a function with an incorrect type, which will fail? (it is worth building your source files with -Werror (warnings are errors), as warnings can indicate undefined behavior which can cause this)"),w("Build with ASSERTIONS=2 for more info."),Vt(e)}Ve=f?function(){var e=t.hrtime();return 1e3*e[0]+e[1]/1e6}:"undefined"!=typeof dateNow?dateNow:"object"==typeof self&&self.performance&&"function"==typeof self.performance.now?function(){return self.performance.now()}:"object"==typeof performance&&"function"==typeof performance.now?function(){return performance.now()}:Date.now,o.wasmTableSize=12930,o.wasmMaxTableSize=12930,o.asmGlobalArg={},o.asmLibraryArg={abort:Vt,assert:M,enlargeMemory:oe,getTotalMemory:se,setTempRet0:g,getTempRet0:b,abortOnCannotGrowMemory:ae,abortStackOverflow:re,nullFunc_didi:tt,nullFunc_ii:it,nullFunc_iii:nt,nullFunc_iiii:rt,nullFunc_iiiiiii:at,nullFunc_iiiiiiiiii:ot,nullFunc_iiiiiiiiiii:ut,nullFunc_iiiiiiiiiiii:lt,nullFunc_iiiiiiiiiiiiiii:st,nullFunc_vi:ft,nullFunc_vii:ct,nullFunc_viiffi:dt,nullFunc_viii:ht,nullFunc_viiii:_t,nullFunc_viiiii:pt,nullFunc_viiiiiii:mt,nullFunc_viiiiiiii:wt,nullFunc_viiiiiiiii:Tt,nullFunc_viiiiiiiiii:yt,___lock:ke,___setErrNo:qe,___syscall140:He,___syscall146:Be,___syscall54:We,___syscall6:je,___unlock:Ye,_abort:ze,_clock_gettime:Ke,_emscripten_get_now:Ve,_emscripten_get_now_is_monotonic:Ge,_emscripten_memcpy_big:et,_gettimeofday:Je,_llvm_cos_f64:Ze,_llvm_sin_f64:$e,flush_NO_FILESYSTEM:Qe,DYNAMICTOP_PTR:te,tempDoublePtr:Le};var Et=o.asm(o.asmGlobalArg,o.asmLibraryArg,Q),gt=Et._fftwf_destroy_plan;Et._fftwf_destroy_plan=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),gt.apply(null,arguments)};var bt=Et._fftwf_execute;Et._fftwf_execute=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),bt.apply(null,arguments)};var vt=Et._fftwf_free;Et._fftwf_free=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),vt.apply(null,arguments)};var Rt=Et._fftwf_malloc;Et._fftwf_malloc=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Rt.apply(null,arguments)};var Mt=Et._fftwf_plan_dft_1d;Et._fftwf_plan_dft_1d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Mt.apply(null,arguments)};var Ot=Et._fftwf_plan_dft_2d;Et._fftwf_plan_dft_2d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ot.apply(null,arguments)};var At=Et._fftwf_plan_dft_c2r_1d;Et._fftwf_plan_dft_c2r_1d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),At.apply(null,arguments)};var It=Et._fftwf_plan_dft_r2c_1d;Et._fftwf_plan_dft_r2c_1d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),It.apply(null,arguments)};var St=Et._fftwf_plan_r2r_1d;Et._fftwf_plan_r2r_1d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),St.apply(null,arguments)};var Nt=Et._fftwf_plan_r2r_2d;Et._fftwf_plan_r2r_2d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Nt.apply(null,arguments)};var xt=Et._free;Et._free=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),xt.apply(null,arguments)};var Ft=Et._llvm_bswap_i32;Et._llvm_bswap_i32=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ft.apply(null,arguments)};var Ut=Et._malloc;Et._malloc=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ut.apply(null,arguments)};var Xt=Et._memmove;Et._memmove=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Xt.apply(null,arguments)};var Dt=Et._sbrk;Et._sbrk=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Dt.apply(null,arguments)};var Pt=Et.establishStackSpace;Et.establishStackSpace=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Pt.apply(null,arguments)};var Lt=Et.setThrew;Et.setThrew=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Lt.apply(null,arguments)};var kt=Et.stackAlloc;Et.stackAlloc=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),kt.apply(null,arguments)};var Ct=Et.stackRestore;Et.stackRestore=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ct.apply(null,arguments)};var Ht=Et.stackSave;Et.stackSave=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),Ht.apply(null,arguments)},o.asm=Et,o._fftwf_destroy_plan=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._fftwf_destroy_plan.apply(null,arguments)},o._fftwf_execute=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._fftwf_execute.apply(null,arguments)},o._fftwf_free=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._fftwf_free.apply(null,arguments)},o._fftwf_malloc=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._fftwf_malloc.apply(null,arguments)},o._fftwf_plan_dft_1d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._fftwf_plan_dft_1d.apply(null,arguments)},o._fftwf_plan_dft_2d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._fftwf_plan_dft_2d.apply(null,arguments)},o._fftwf_plan_dft_c2r_1d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._fftwf_plan_dft_c2r_1d.apply(null,arguments)},o._fftwf_plan_dft_r2c_1d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._fftwf_plan_dft_r2c_1d.apply(null,arguments)},o._fftwf_plan_r2r_1d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._fftwf_plan_r2r_1d.apply(null,arguments)},o._fftwf_plan_r2r_2d=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._fftwf_plan_r2r_2d.apply(null,arguments)},o._free=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._free.apply(null,arguments)},o._llvm_bswap_i32=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._llvm_bswap_i32.apply(null,arguments)},o._malloc=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._malloc.apply(null,arguments)},o._memcpy=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._memcpy.apply(null,arguments)},o._memmove=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._memmove.apply(null,arguments)},o._memset=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._memset.apply(null,arguments)},o._sbrk=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm._sbrk.apply(null,arguments)},o.establishStackSpace=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.establishStackSpace.apply(null,arguments)},o.setThrew=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.setThrew.apply(null,arguments)};var Qt=o.stackAlloc=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.stackAlloc.apply(null,arguments)},Bt=o.stackRestore=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.stackRestore.apply(null,arguments)},Wt=o.stackSave=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.stackSave.apply(null,arguments)};function jt(e){this.name="ExitStatus",this.message="Program terminated with exit("+e+")",this.status=e}function Yt(e){function t(){o.calledRun||(o.calledRun=!0,R||(Te(),ye(),o.onRuntimeInitialized&&o.onRuntimeInitialized(),M(!o._main,'compiled without a main, but one is present. if you added it from JS, use Module["onRuntimeInitialized"]'),Ee()))}e=e||o.arguments,Oe>0||(ie(),we(),Oe>0||o.calledRun||(o.setStatus?(o.setStatus("Running..."),setTimeout((function(){setTimeout((function(){o.setStatus("")}),1),t()}),1)):t(),ne()))}o.dynCall_didi=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_didi.apply(null,arguments)},o.dynCall_ii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_ii.apply(null,arguments)},o.dynCall_iii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_iii.apply(null,arguments)},o.dynCall_iiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_iiii.apply(null,arguments)},o.dynCall_iiiiiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_iiiiiii.apply(null,arguments)},o.dynCall_iiiiiiiiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_iiiiiiiiii.apply(null,arguments)},o.dynCall_iiiiiiiiiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_iiiiiiiiiii.apply(null,arguments)},o.dynCall_iiiiiiiiiiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_iiiiiiiiiiii.apply(null,arguments)},o.dynCall_iiiiiiiiiiiiiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_iiiiiiiiiiiiiii.apply(null,arguments)},o.dynCall_vi=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_vi.apply(null,arguments)},o.dynCall_vii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_vii.apply(null,arguments)},o.dynCall_viiffi=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_viiffi.apply(null,arguments)},o.dynCall_viii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_viii.apply(null,arguments)},o.dynCall_viiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_viiii.apply(null,arguments)},o.dynCall_viiiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_viiiii.apply(null,arguments)},o.dynCall_viiiiiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_viiiiiii.apply(null,arguments)},o.dynCall_viiiiiiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_viiiiiiii.apply(null,arguments)},o.dynCall_viiiiiiiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_viiiiiiiii.apply(null,arguments)},o.dynCall_viiiiiiiiii=function(){return M(pe,"you need to wait for the runtime to be ready (e.g. wait for main() to be called)"),M(!me,"the runtime was exited (use NO_EXIT_RUNTIME to keep it alive after main() exits)"),o.asm.dynCall_viiiiiiiiii.apply(null,arguments)},o.asm=Et,o.intArrayFromString||(o.intArrayFromString=function(){Vt("'intArrayFromString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.intArrayToString||(o.intArrayToString=function(){Vt("'intArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.ccall=S,o.cwrap=N,o.setValue||(o.setValue=function(){Vt("'setValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.getValue||(o.getValue=function(){Vt("'getValue' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.allocate||(o.allocate=function(){Vt("'allocate' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.getMemory||(o.getMemory=function(){Vt("'getMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),o.Pointer_stringify||(o.Pointer_stringify=function(){Vt("'Pointer_stringify' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.AsciiToString||(o.AsciiToString=function(){Vt("'AsciiToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.stringToAscii||(o.stringToAscii=function(){Vt("'stringToAscii' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.UTF8ArrayToString||(o.UTF8ArrayToString=function(){Vt("'UTF8ArrayToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.UTF8ToString||(o.UTF8ToString=function(){Vt("'UTF8ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.stringToUTF8Array||(o.stringToUTF8Array=function(){Vt("'stringToUTF8Array' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.stringToUTF8||(o.stringToUTF8=function(){Vt("'stringToUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.lengthBytesUTF8||(o.lengthBytesUTF8=function(){Vt("'lengthBytesUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.UTF16ToString||(o.UTF16ToString=function(){Vt("'UTF16ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.stringToUTF16||(o.stringToUTF16=function(){Vt("'stringToUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.lengthBytesUTF16||(o.lengthBytesUTF16=function(){Vt("'lengthBytesUTF16' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.UTF32ToString||(o.UTF32ToString=function(){Vt("'UTF32ToString' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.stringToUTF32||(o.stringToUTF32=function(){Vt("'stringToUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.lengthBytesUTF32||(o.lengthBytesUTF32=function(){Vt("'lengthBytesUTF32' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.allocateUTF8||(o.allocateUTF8=function(){Vt("'allocateUTF8' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.stackTrace||(o.stackTrace=function(){Vt("'stackTrace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.addOnPreRun||(o.addOnPreRun=function(){Vt("'addOnPreRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.addOnInit||(o.addOnInit=function(){Vt("'addOnInit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.addOnPreMain||(o.addOnPreMain=function(){Vt("'addOnPreMain' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.addOnExit||(o.addOnExit=function(){Vt("'addOnExit' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.addOnPostRun||(o.addOnPostRun=function(){Vt("'addOnPostRun' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.writeStringToMemory||(o.writeStringToMemory=function(){Vt("'writeStringToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.writeArrayToMemory||(o.writeArrayToMemory=function(){Vt("'writeArrayToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.writeAsciiToMemory||(o.writeAsciiToMemory=function(){Vt("'writeAsciiToMemory' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.addRunDependency||(o.addRunDependency=function(){Vt("'addRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),o.removeRunDependency||(o.removeRunDependency=function(){Vt("'removeRunDependency' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),o.ENV||(o.ENV=function(){Vt("'ENV' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.FS||(o.FS=function(){Vt("'FS' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.FS_createFolder||(o.FS_createFolder=function(){Vt("'FS_createFolder' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),o.FS_createPath||(o.FS_createPath=function(){Vt("'FS_createPath' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),o.FS_createDataFile||(o.FS_createDataFile=function(){Vt("'FS_createDataFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),o.FS_createPreloadedFile||(o.FS_createPreloadedFile=function(){Vt("'FS_createPreloadedFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),o.FS_createLazyFile||(o.FS_createLazyFile=function(){Vt("'FS_createLazyFile' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),o.FS_createLink||(o.FS_createLink=function(){Vt("'FS_createLink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),o.FS_createDevice||(o.FS_createDevice=function(){Vt("'FS_createDevice' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),o.FS_unlink||(o.FS_unlink=function(){Vt("'FS_unlink' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ). Alternatively, forcing filesystem support (-s FORCE_FILESYSTEM=1) can export this for you")}),o.GL||(o.GL=function(){Vt("'GL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.dynamicAlloc||(o.dynamicAlloc=function(){Vt("'dynamicAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.warnOnce||(o.warnOnce=function(){Vt("'warnOnce' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.loadDynamicLibrary||(o.loadDynamicLibrary=function(){Vt("'loadDynamicLibrary' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.loadWebAssemblyModule||(o.loadWebAssemblyModule=function(){Vt("'loadWebAssemblyModule' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.getLEB||(o.getLEB=function(){Vt("'getLEB' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.getFunctionTables||(o.getFunctionTables=function(){Vt("'getFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.alignFunctionTables||(o.alignFunctionTables=function(){Vt("'alignFunctionTables' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.registerFunctions||(o.registerFunctions=function(){Vt("'registerFunctions' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.addFunction||(o.addFunction=function(){Vt("'addFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.removeFunction||(o.removeFunction=function(){Vt("'removeFunction' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.getFuncWrapper||(o.getFuncWrapper=function(){Vt("'getFuncWrapper' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.prettyPrint||(o.prettyPrint=function(){Vt("'prettyPrint' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.makeBigInt||(o.makeBigInt=function(){Vt("'makeBigInt' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.dynCall||(o.dynCall=function(){Vt("'dynCall' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.getCompilerSetting||(o.getCompilerSetting=function(){Vt("'getCompilerSetting' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.stackSave||(o.stackSave=function(){Vt("'stackSave' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.stackRestore||(o.stackRestore=function(){Vt("'stackRestore' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.stackAlloc||(o.stackAlloc=function(){Vt("'stackAlloc' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.establishStackSpace||(o.establishStackSpace=function(){Vt("'establishStackSpace' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.print||(o.print=function(){Vt("'print' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.printErr||(o.printErr=function(){Vt("'printErr' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.getTempRet0||(o.getTempRet0=function(){Vt("'getTempRet0' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.setTempRet0||(o.setTempRet0=function(){Vt("'setTempRet0' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}),o.ALLOC_NORMAL||Object.defineProperty(o,"ALLOC_NORMAL",{get:function(){Vt("'ALLOC_NORMAL' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),o.ALLOC_STACK||Object.defineProperty(o,"ALLOC_STACK",{get:function(){Vt("'ALLOC_STACK' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),o.ALLOC_DYNAMIC||Object.defineProperty(o,"ALLOC_DYNAMIC",{get:function(){Vt("'ALLOC_DYNAMIC' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),o.ALLOC_NONE||Object.defineProperty(o,"ALLOC_NONE",{get:function(){Vt("'ALLOC_NONE' was not exported. add it to EXTRA_EXPORTED_RUNTIME_METHODS (see the FAQ)")}}),o.then=function(e){if(o.calledRun)e(o);else{var t=o.onRuntimeInitialized;o.onRuntimeInitialized=function(){t&&t(),e(o)}}return o},jt.prototype=new Error,jt.prototype.constructor=jt,Ie=function e(){o.calledRun||Yt(),o.calledRun||(Ie=e)},o.run=Yt;var zt=[];function Vt(e){o.onAbort&&o.onAbort(e),void 0!==e?(m(e),w(e),e=JSON.stringify(e)):e="",R=!0;var t="abort("+e+") at "+H();throw zt&&zt.forEach((function(i){t=i(t,e)})),t}if(o.abort=Vt,o.preInit)for("function"==typeof o.preInit&&(o.preInit=[o.preInit]);o.preInit.length>0;)o.preInit.pop()();return o.noExitRuntime=!0,Yt(),e});e.exports=a}).call(this,i(0),"/")},function(e,t,i){(function(e){function i(e,t){for(var i=0,n=e.length-1;n>=0;n--){var r=e[n];"."===r?e.splice(n,1):".."===r?(e.splice(n,1),i++):i&&(e.splice(n,1),i--)}if(t)for(;i--;i)e.unshift("..");return e}function n(e,t){if(e.filter)return e.filter(t);for(var i=[],n=0;n<e.length;n++)t(e[n],n,e)&&i.push(e[n]);return i}t.resolve=function(){for(var t="",r=!1,a=arguments.length-1;a>=-1&&!r;a--){var o=a>=0?arguments[a]:e.cwd();if("string"!=typeof o)throw new TypeError("Arguments to path.resolve must be strings");o&&(t=o+"/"+t,r="/"===o.charAt(0))}return(r?"/":"")+(t=i(n(t.split("/"),(function(e){return!!e})),!r).join("/"))||"."},t.normalize=function(e){var a=t.isAbsolute(e),o="/"===r(e,-1);return(e=i(n(e.split("/"),(function(e){return!!e})),!a).join("/"))||a||(e="."),e&&o&&(e+="/"),(a?"/":"")+e},t.isAbsolute=function(e){return"/"===e.charAt(0)},t.join=function(){var e=Array.prototype.slice.call(arguments,0);return t.normalize(n(e,(function(e,t){if("string"!=typeof e)throw new TypeError("Arguments to path.join must be strings");return e})).join("/"))},t.relative=function(e,i){function n(e){for(var t=0;t<e.length&&""===e[t];t++);for(var i=e.length-1;i>=0&&""===e[i];i--);return t>i?[]:e.slice(t,i-t+1)}e=t.resolve(e).substr(1),i=t.resolve(i).substr(1);for(var r=n(e.split("/")),a=n(i.split("/")),o=Math.min(r.length,a.length),u=o,l=0;l<o;l++)if(r[l]!==a[l]){u=l;break}var s=[];for(l=u;l<r.length;l++)s.push("..");return(s=s.concat(a.slice(u))).join("/")},t.sep="/",t.delimiter=":",t.dirname=function(e){if("string"!=typeof e&&(e+=""),0===e.length)return".";for(var t=e.charCodeAt(0),i=47===t,n=-1,r=!0,a=e.length-1;a>=1;--a)if(47===(t=e.charCodeAt(a))){if(!r){n=a;break}}else r=!1;return-1===n?i?"/":".":i&&1===n?"/":e.slice(0,n)},t.basename=function(e,t){var i=function(e){"string"!=typeof e&&(e+="");var t,i=0,n=-1,r=!0;for(t=e.length-1;t>=0;--t)if(47===e.charCodeAt(t)){if(!r){i=t+1;break}}else-1===n&&(r=!1,n=t+1);return-1===n?"":e.slice(i,n)}(e);return t&&i.substr(-1*t.length)===t&&(i=i.substr(0,i.length-t.length)),i},t.extname=function(e){"string"!=typeof e&&(e+="");for(var t=-1,i=0,n=-1,r=!0,a=0,o=e.length-1;o>=0;--o){var u=e.charCodeAt(o);if(47!==u)-1===n&&(r=!1,n=o+1),46===u?-1===t?t=o:1!==a&&(a=1):-1!==t&&(a=-1);else if(!r){i=o+1;break}}return-1===t||-1===n||0===a||1===a&&t===n-1&&t===i+1?"":e.slice(t,n)};var r="b"==="ab".substr(-1)?function(e,t,i){return e.substr(t,i)}:function(e,t,i){return t<0&&(t=e.length+t),e.substr(t,i)}}).call(this,i(0))}])}));
CCWT.onReady = function () {

};

/***********************************************************
    Fields.
************************************************************/

var _progress = 0,
    _prev_progress = 0,
    _stereo = false;

/***********************************************************
    Functions.
************************************************************/

var _convert = function (params, data) {
/*
    var note_time = params.note_time,
        note_samples = Math.round(note_time * params.sample_rate),

        window_size = params.settings.window_length,
        window_type = params.settings.window_type,
        
        window_alpha = params.settings.window_alpha,
        
        hop_divisor = params.settings.overlap, // overlap factor
        hop_length = Math.round(window_size / hop_divisor),
        
        stft_result_length = Math.round(window_size / 2),

        data_buffer = data,

        image_width  = Math.ceil(data_buffer.length / note_samples),
        image_height = params.settings.height,//note_samples,
        image_height_m1 = params.settings.height - 1,
                
        min_freq = params.settings.minfreq,
        max_freq = params.settings.maxfreq,
        
        overlap_frame_buffer = [],
        stft,

        image_data = new Uint8ClampedArray(image_width * image_height * 4),
        
        min_stft_freq = params.sample_rate / window_size,
        
        // id boundaries of the stft result matching our scale settings
        lid = Math.round(min_freq / min_stft_freq),
        hid = Math.round(max_freq / min_stft_freq),
        
        start = stft_result_length + lid,
        end = stft_result_length + lid + hid,
        
        n, adiff, amax = 0, amin = 255,
        
        progress_step = note_samples / data_buffer.length * 100,
    
        i,
        
        frame = 0;
*/
    var length_in_seconds = data.length / params.sample_rate,
    
        height = params.settings.height,

        minimum_frequency = params.settings.minfreq * length_in_seconds,
        maximum_frequency = params.settings.maxfreq * length_in_seconds,
    
        deviation = params.settings.deviation,

        // linear
        frequency_basis_linear = 0,
        frequency_range_linear = maximum_frequency - minimum_frequency,
        frequency_offset_linear = minimum_frequency,

        // logarithmic
        frequency_basis_log = 2.0, // each octave double the frequency
        minimum_octave = Math.log(minimum_frequency) / Math.log(frequency_basis_log),
        maximum_octave = Math.log(maximum_frequency) / Math.log(frequency_basis_log),

        frequency_range_log = maximum_octave - minimum_octave,
        frequency_offset_log = minimum_octave,

        frequencies = null,

        padding = params.settings.padding,

        gain_factor = params.settings.gain,
        fourier_transformed_signal,

        pixels_per_second = params.settings.pps,

        output_width,

        row_callback,
        
        image_data;

    
    if (params.settings.mapping === "linear") {
        // linear
        frequencies = CCWT.frequencyBand(height, frequency_range_linear, frequency_offset_linear, frequency_basis_linear, deviation);
    } else {
        // logarithmic
        frequencies = CCWT.frequencyBand(height, frequency_range_log, frequency_offset_log, frequency_basis_log, deviation);
    }

    // add some padding to avoid start / end oddities (when there is data at one/both end of the signal)
    fourier_transformed_signal = CCWT.fft1d(data, padding, gain_factor);

    output_width = Math.floor(length_in_seconds * pixels_per_second);

    image_data = new Uint8ClampedArray(output_width * height * 4);

    row_callback = function (y, row_data, output_padding) {
        var _progress = Math.round(y / height * 100);

        if (_progress != _prev_progress) {
            _prev_progress = _progress;

            var current_progress = _stereo ? _prev_progress / 2 : _prev_progress;

            if (current_progress % 5 === 0) {
                postMessage(current_progress);
            }
        }
        
        var x = 0
        for (x = 0; x < output_width; ++x) {
            var r = row_data[output_padding * 2 + x * 2];
            var i = row_data[output_padding * 2 + x * 2 + 1];

            var amplitude_raw = Math.hypot(r, i);

            // linear intensity
            var value_sign = (0 < amplitude_raw) - (amplitude_raw < 0);
            var amplitude = Math.min(amplitude_raw * value_sign, 1.0) * value_sign;
            
            var color = Math.round(amplitude * 255);

            var index = y * output_width * 4 + x * 4;
            image_data[index] = color;
            image_data[index + 1] = color;
            image_data[index + 2] = color;
            image_data[index + 3] = 255;
        }
    };

    CCWT.numericOutput(fourier_transformed_signal, padding, frequencies, 0, frequencies.length / 2, output_width, row_callback);

    var i, n, amax = 0, amin = 255, adiff;

    // mag. normalization
    for (i = 0; i < image_data.length; i += 4) {
        n = image_data[i];
        amax = n > amax ? n : amax;
        amin = n < amin ? n : amin;
    }

    adiff = 255 / (amax - amin);

    for (i = 0; i < image_data.length; i += 4) {
        image_data[i] -= amin;
        image_data[i + 1] -= amin;
        image_data[i + 2] -= amin;
        
        image_data[i] *= adiff;
        image_data[i + 1] *= adiff;
        image_data[i + 2] *= adiff;
    }
   
    return { width: output_width, height: height, data: image_data };
};

// when in stereo, we basically assign R = L, G = R and G = (L + R) / 2
var _mergeChannels = function (l, r) {
    var i = 0;
    
    for (i = 0; i < l.length; i += 4) {
        l[i + 1] = r[i + 1];
        l[i + 2] = (l[i] + r[i + 1]) / 2;
        l[i + 3] = (l[i + 3] + r[i + 3]) / 2;
    }
    
    return l;
};

self.onmessage = function (m) {
    "use strict";

    var data = m.data,

        l = new Float32Array(data.left),
        r = null,
        
        ll = null,
        rr = null,
        
        result = {
            pbuffer: null,
            width: null,
            height: null
        };
    
    _progress = 0;
    
    _stereo = (data.right !== null);
    
    ll = _convert(data, l);

    if (data.right) {
        r = new Float32Array(data.right);
        rr = _convert(data, r);
        
        result.pbuffer = _mergeChannels(ll.data, rr.data).buffer;
    } else {
        result.pbuffer = ll.data.buffer;
    }

    result.width = ll.width;
    result.height = ll.height;
    
    postMessage(result, [result.pbuffer]);
};
